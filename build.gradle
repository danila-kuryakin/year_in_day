buildscript {
    repositories {
	jcenter()
	mavenCentral()
    }
    dependencies {
        classpath 'com.bmuschko:gradle-docker-plugin:6.1.1'
    }
}

apply plugin: 'com.bmuschko.docker-remote-api'

import com.bmuschko.gradle.docker.tasks.image.*


task createDockerfile(type: Dockerfile) {
    destFile = project.file('./Dockerfile')
    from 'python:2.7'
    runCommand 'pip install flask'
    addFile('./app', '/app')
    workingDir('/app')
    exposePort 80
    defaultCommand('python2','app.py')  
}

task startService(type: DockerBuildImage) {
    dependsOn createDockerfile
    inputDir = createDockerfile.destFile.get().asFile.parentFile
}